INSERT IGNORE INTO tour (id, company, name, country, max_capacity, min_capacity, start_date, end_date, price_adult, price_youth, price_infant, hotel_price_sum)
VALUES
(1, 'GlobalTravel', 'Tour1', 'KR', 28, 5, '2025-08-01', '2025-08-05', 1010000, 510000, 110000, 0),
(2, 'SkyTours', 'Tour2', 'JP', 10, 5, '2025-08-02', '2025-08-06', 1020000, 510000, 110000, 0),
(3, 'GlobalTravel', 'Tour3', 'CN', 12, 5, '2025-08-03', '2025-08-07', 1030000, 510000, 110000, 0),
(4, 'AdventurePlus', 'Tour4', 'US', 11, 5, '2025-08-04', '2025-08-08', 1040000, 510000, 110000, 0),
(5, 'SkyTours', 'Tour5', 'CA', 10, 5, '2025-08-05', '2025-08-09', 1050000, 510000, 110000, 0),
(6, 'WorldExplorer', 'Tour6', 'AU', 14, 5, '2025-08-06', '2025-08-10', 1060000, 510000, 110000, 0),
(7, 'GlobalTravel', 'Tour7', 'FR', 29, 5, '2025-08-07', '2025-08-11', 1070000, 510000, 110000, 0),
(8, 'SkyTours', 'Tour8', 'DE', 23, 5, '2025-08-08', '2025-08-12', 1080000, 510000, 110000, 0),
(9, 'AdventurePlus', 'Tour9', 'IT', 34, 5, '2025-08-09', '2025-08-13', 1090000, 510000, 110000, 0),
(10, 'GlobalTravel', 'Tour10', 'ES', 14, 5, '2025-08-10', '2025-08-14', 1100000, 510000, 110000, 0),
(11, 'WorldExplorer', 'Tour11', 'GB', 25, 5, '2025-08-11', '2025-08-15', 1110000, 510000, 110000, 0),
(12, 'SkyTours', 'Tour12', 'BR', 34, 5, '2025-08-12', '2025-08-16', 1120000, 510000, 110000, 0),
(13, 'AdventurePlus', 'Tour13', 'AR', 21, 5, '2025-08-13', '2025-08-17', 1130000, 510000, 110000, 0),
(14, 'SkyTours', 'Tour14', 'MX', 33, 5, '2025-08-14', '2025-08-18', 1140000, 510000, 110000, 0),
(15, 'GlobalTravel', 'Tour15', 'IN', 17, 5, '2025-08-15', '2025-08-19', 1150000, 510000, 110000, 0),
(16, 'WorldExplorer', 'Tour16', 'RU', 39, 5, '2025-08-16', '2025-08-20', 1160000, 510000, 110000, 0),
(17, 'SkyTours', 'Tour17', 'TR', 39, 5, '2025-08-17', '2025-08-21', 1170000, 510000, 110000, 0),
(18, 'AdventurePlus', 'Tour18', 'EG', 22, 5, '2025-08-18', '2025-08-22', 1180000, 510000, 110000, 0),
(19, 'SkyTours', 'Tour19', 'ZA', 14, 5, '2025-08-19', '2025-08-23', 1190000, 510000, 110000, 0),
(20, 'GlobalTravel', 'Tour20', 'ID', 26, 5, '2025-08-20', '2025-08-24', 1200000, 510000, 110000, 0);

INSERT IGNORE INTO schedule (id, tour_id, day) 
VALUES 
(1, 1, 0),
(2, 1, 1),
(3, 1, 2),
(4, 2, 0),
(5, 2, 1),
(6, 3, 0),
(7, 3, 1),
(8, 4, 0),
(9, 4, 1),
(10, 5, 0),
(11, 5, 1),
(12, 5, 2),
(13, 6, 0),
(14, 6, 1),
(15, 6, 2),
(16, 7, 0),
(17, 7, 1),
(18, 7, 2),
(19, 8, 0),
(20, 8, 1),
(21, 9, 0),
(22, 9, 1),
(23, 9, 2),
(24, 10, 0),
(25, 10, 1),
(26, 10, 2),
(27, 11, 0),
(28, 11, 1),
(29, 12, 0),
(30, 12, 1),
(31, 12, 2),
(32, 13, 0),
(33, 13, 1),
(34, 13, 2),
(35, 14, 0),
(36, 14, 1),
(37, 14, 2),
(38, 15, 0),
(39, 15, 1),
(40, 16, 0),
(41, 16, 1),
(42, 17, 0),
(43, 17, 1),
(44, 18, 0),
(45, 18, 1),
(46, 19, 0),
(47, 19, 1),
(48, 19, 2),
(49, 20, 0),
(50, 20, 1);

INSERT IGNORE INTO location (locations_order, id, schedule_id, location_type, name, description, city, depart_airport, arrive_airport, hotel_id) VALUES
(0,1,1,'AIR','방콕','AIR activity for Tour1',NULL,'BKK','SFO',NULL),
(1,2,1,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour1','HKG',NULL,NULL,4),
(2,3,1,'POINT','에펠탑','POINT activity for Tour1','PAR',NULL,NULL,NULL),
(0,4,2,'AIR','시드니','AIR activity for Tour1',NULL,'SYD','TYO',NULL),
(1,5,2,'POINT','빅토리아 항구','POINT activity for Tour1','HKG',NULL,NULL,NULL),
(2,6,2,'AIR','도쿄','AIR activity for Tour1',NULL,'TYO','ROM',NULL),
(0,7,3,'HOTEL','파리 센트럴 호텔','HOTEL activity for Tour1','PAR',NULL,NULL,2),
(1,8,3,'AIR','시카고','AIR activity for Tour1',NULL,'CHI','LAX',NULL),
(0,9,4,'HOTEL','방콕 팰리스','HOTEL activity for Tour2','BKK',NULL,NULL,5),
(1,10,4,'HOTEL','샌프란시스코 베이 호텔','HOTEL activity for Tour2','SFO',NULL,NULL,4),
(2,11,4,'HOTEL','시카고 시티 호텔','HOTEL activity for Tour2','CHI',NULL,NULL,3),
(0,12,5,'AIR','홍콩','AIR activity for Tour2',NULL,'HKG','BKK',NULL),
(1,13,5,'HOTEL','샌프란시스코 베이 호텔','HOTEL activity for Tour2','SFO',NULL,NULL,3),
(0,14,6,'POINT','루브르 박물관','POINT activity for Tour3','PAR',NULL,NULL,NULL),
(1,15,6,'HOTEL','도쿄 타워 호텔','HOTEL activity for Tour3','TYO',NULL,NULL,3),
(0,16,7,'AIR','서울','AIR activity for Tour3',NULL,'SEL','BKK',NULL),
(1,17,7,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour3','LAX',NULL,NULL,4),
(2,18,7,'HOTEL','샌프란시스코 베이 호텔','HOTEL activity for Tour3','SFO',NULL,NULL,2),
(0,19,8,'HOTEL','서울 그랜드 호텔','HOTEL activity for Tour4','SEL',NULL,NULL,5),
(1,20,8,'HOTEL','싱가포르 시티 호텔','HOTEL activity for Tour4','SIN',NULL,NULL,3),
(0,21,9,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour4','LAX',NULL,NULL,5),
(1,22,9,'HOTEL','시카고 시티 호텔','HOTEL activity for Tour4','CHI',NULL,NULL,2),
(2,23,9,'POINT','골든 게이트 브릿지','POINT activity for Tour4','SFO',NULL,NULL,NULL),
(0,24,10,'HOTEL','샌프란시스코 베이 호텔','HOTEL activity for Tour5','SFO',NULL,NULL,4),
(1,25,10,'POINT','타이페이 101','POINT activity for Tour5','SFO',NULL,NULL,NULL),
(0,26,11,'HOTEL','베를린 시티 호텔','HOTEL activity for Tour5','BER',NULL,NULL,5),
(1,27,11,'HOTEL','뉴욕 시티 호텔','HOTEL activity for Tour5','NYC',NULL,NULL,2),
(2,28,11,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour5','LAX',NULL,NULL,2),
(0,29,12,'HOTEL','파리 센트럴 호텔','HOTEL activity for Tour5','PAR',NULL,NULL,3),
(1,30,12,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour5','HKG',NULL,NULL,3),
(2,31,12,'POINT','수상시장','POINT activity for Tour5','BKK',NULL,NULL,NULL),
(0,32,13,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour6','HKG',NULL,NULL,5),
(1,33,13,'AIR','서울','AIR activity for Tour6',NULL,'SEL','LAX',NULL),
(2,34,13,'POINT','경복궁','POINT activity for Tour6','SEL',NULL,NULL,NULL),
(0,35,14,'POINT','아유타야 유적지','POINT activity for Tour6','BKK',NULL,NULL,NULL),
(1,36,14,'AIR','뉴욕','AIR activity for Tour6',NULL,'NYC','HKG',NULL),
(2,37,14,'AIR','로마','AIR activity for Tour6',NULL,'ROM','CHI',NULL),
(0,38,15,'HOTEL','시드니 하버 호텔','HOTEL activity for Tour6','SYD',NULL,NULL,5),
(1,39,15,'POINT','수상시장','POINT activity for Tour6','BKK',NULL,NULL,NULL),
(0,40,16,'AIR','파리','AIR activity for Tour7',NULL,'PAR','LON',NULL),
(1,41,16,'AIR','뉴욕','AIR activity for Tour7',NULL,'NYC','HKG',NULL),
(2,42,16,'HOTEL','베를린 시티 호텔','HOTEL activity for Tour7','BER',NULL,NULL,5),
(0,43,17,'AIR','시드니','AIR activity for Tour7',NULL,'SYD','BER',NULL),
(1,44,17,'HOTEL','로마 시티 호텔','HOTEL activity for Tour7','ROM',NULL,NULL,3),
(0,45,18,'AIR','샌프란시스코','AIR activity for Tour7',NULL,'SFO','BER',NULL),
(1,46,18,'POINT','브란덴부르크 문','POINT activity for Tour7','BER',NULL,NULL,NULL),
(0,47,19,'POINT','콜로세움','POINT activity for Tour8','ROM',NULL,NULL,NULL),
(1,48,19,'AIR','서울','AIR activity for Tour8',NULL,'SEL','NYC',NULL),
(2,49,19,'AIR','뉴욕','AIR activity for Tour8',NULL,'NYC','SEL',NULL),
(0,50,20,'AIR','샌프란시스코','AIR activity for Tour8',NULL,'SFO','NYC',NULL),
(1,51,20,'AIR','도쿄','AIR activity for Tour8',NULL,'TYO','LON',NULL),
(0,52,21,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour9','LAX',NULL,NULL,4),
(1,53,21,'HOTEL','뉴욕 시티 호텔','HOTEL activity for Tour9','NYC',NULL,NULL,4),
(0,54,22,'POINT','수상시장','POINT activity for Tour9','BKK',NULL,NULL,NULL),
(1,55,22,'AIR','방콕','AIR activity for Tour9',NULL,'BKK','BER',NULL),
(2,56,22,'HOTEL','로마 시티 호텔','HOTEL activity for Tour9','ROM',NULL,NULL,2),
(0,57,23,'POINT','부르주 광장','POINT activity for Tour9','DXB',NULL,NULL,NULL),
(1,58,23,'POINT','브로드웨이','POINT activity for Tour9','NYC',NULL,NULL,NULL),
(0,59,24,'AIR','시카고','AIR activity for Tour10',NULL,'CHI','DXB',NULL),
(1,60,24,'HOTEL','방콕 팰리스','HOTEL activity for Tour10','BKK',NULL,NULL,3),
(0,61,25,'POINT','콜로세움','POINT activity for Tour10','ROM',NULL,NULL,NULL),
(1,62,25,'HOTEL','시드니 하버 호텔','HOTEL activity for Tour10','SYD',NULL,NULL,4),
(0,63,26,'POINT','부르주 광장','POINT activity for Tour10','DXB',NULL,NULL,NULL),
(1,64,26,'HOTEL','시드니 하버 호텔','HOTEL activity for Tour10','SYD',NULL,NULL,3),
(0,65,27,'AIR','로마','AIR activity for Tour11',NULL,'ROM','BER',NULL),
(1,66,27,'POINT','빅토리아 항구','POINT activity for Tour11','HKG',NULL,NULL,NULL),
(0,67,28,'HOTEL','시드니 하버 호텔','HOTEL activity for Tour11','SYD',NULL,NULL,2),
(1,68,28,'HOTEL','서울 그랜드 호텔','HOTEL activity for Tour11','SEL',NULL,NULL,2),
(2,69,28,'AIR','도쿄','AIR activity for Tour11',NULL,'TYO','LON',NULL),
(0,70,29,'HOTEL','시카고 시티 호텔','HOTEL activity for Tour12','CHI',NULL,NULL,3),
(1,71,29,'HOTEL','도쿄 타워 호텔','HOTEL activity for Tour12','TYO',NULL,NULL,5),
(2,72,29,'HOTEL','부르주 광장 호텔','HOTEL activity for Tour12','DXB',NULL,NULL,5),
(0,73,30,'AIR','시드니','AIR activity for Tour12',NULL,'SYD','NYC',NULL),
(1,74,30,'POINT','홍콩 빅토리아 항구','POINT activity for Tour12','HKG',NULL,NULL,NULL),
(2,75,30,'AIR','런던','AIR activity for Tour12',NULL,'LON','BKK',NULL),
(0,76,31,'POINT','마리나 베이','POINT activity for Tour12','SIN',NULL,NULL,NULL),
(1,77,31,'AIR','런던','AIR activity for Tour12',NULL,'LON','HKG',NULL),
(2,78,31,'POINT','로스앤젤레스 비치','POINT activity for Tour12','LAX',NULL,NULL,NULL),
(0,79,32,'HOTEL','서울 그랜드 호텔','HOTEL activity for Tour13','SEL',NULL,NULL,5),
(1,80,32,'HOTEL','파리 센트럴 호텔','HOTEL activity for Tour13','PAR',NULL,NULL,2),
(0,81,33,'POINT','수상시장','POINT activity for Tour13','BKK',NULL,NULL,NULL),
(1,82,33,'POINT','시카고 비치','POINT activity for Tour13','CHI',NULL,NULL,NULL),
(2,83,33,'POINT','부르주 광장','POINT activity for Tour13','DXB',NULL,NULL,NULL),
(0,84,34,'AIR','샌프란시스코','AIR activity for Tour13',NULL,'SFO','BER',NULL),
(1,85,34,'POINT','마리나 베이','POINT activity for Tour13','SIN',NULL,NULL,NULL),
(2,86,34,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour13','LAX',NULL,NULL,3),
(0,87,35,'HOTEL','시카고 시티 호텔','HOTEL activity for Tour14','CHI',NULL,NULL,4),
(1,88,35,'POINT','브란덴부르크 문','POINT activity for Tour14','BER',NULL,NULL,NULL),
(0,89,36,'POINT','브란덴부르크 문','POINT activity for Tour14','BER',NULL,NULL,NULL),
(1,90,36,'HOTEL','런던 시티 호텔','HOTEL activity for Tour14','LON',NULL,NULL,2),
(2,91,36,'POINT','마리나 베이','POINT activity for Tour14','SIN',NULL,NULL,NULL),
(0,92,37,'POINT','시드니 오페라 하우스','POINT activity for Tour14','SYD',NULL,NULL,NULL),
(1,93,37,'POINT','수상시장','POINT activity for Tour14','BKK',NULL,NULL,NULL),
(2,94,37,'HOTEL','시카고 시티 호텔','HOTEL activity for Tour14','CHI',NULL,NULL,3),
(0,95,38,'AIR','홍콩','AIR activity for Tour15',NULL,'HKG','ROM',NULL),
(1,96,38,'HOTEL','서울 그랜드 호텔','HOTEL activity for Tour15','SEL',NULL,NULL,2),
(0,97,39,'POINT','시카고 비치','POINT activity for Tour15','CHI',NULL,NULL,NULL),
(1,98,39,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour15','HKG',NULL,NULL,2),
(0,99,40,'HOTEL','베를린 시티 호텔','HOTEL activity for Tour16','BER',NULL,NULL,3),
(1,100,40,'AIR','도쿄','AIR activity for Tour16',NULL,'TYO','CHI',NULL),
(0,101,41,'AIR','홍콩','AIR activity for Tour16',NULL,'HKG','BER',NULL),
(1,102,41,'POINT','도쿄 타워','POINT activity for Tour16','TYO',NULL,NULL,NULL),
(2,103,41,'POINT','마리나 베이','POINT activity for Tour16','SIN',NULL,NULL,NULL),
(0,104,42,'POINT','시드니 오페라 하우스','POINT activity for Tour17','SYD',NULL,NULL,NULL),
(1,105,42,'AIR','싱가포르','AIR activity for Tour17',NULL,'SIN','LON',NULL),
(0,106,43,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour17','HKG',NULL,NULL,2),
(1,107,43,'POINT','시카고 비치','POINT activity for Tour17','CHI',NULL,NULL,NULL),
(0,108,44,'AIR','시드니','AIR activity for Tour18',NULL,'SYD','LON',NULL),
(1,109,44,'HOTEL','시드니 하버 호텔','HOTEL activity for Tour18','SYD',NULL,NULL,4),
(0,110,45,'HOTEL','로마 시티 호텔','HOTEL activity for Tour18','ROM',NULL,NULL,2),
(1,111,45,'POINT','브란덴부르크 문','POINT activity for Tour18','BER',NULL,NULL,NULL),
(2,112,45,'HOTEL','홍콩 그랜드 호텔','HOTEL activity for Tour18','HKG',NULL,NULL,4),
(0,113,46,'AIR','도쿄','AIR activity for Tour19',NULL,'TYO','SYD',NULL),
(1,114,46,'HOTEL','뉴욕 시티 호텔','HOTEL activity for Tour19','NYC',NULL,NULL,4),
(0,115,47,'HOTEL','파리 센트럴 호텔','HOTEL activity for Tour19','PAR',NULL,NULL,5),
(1,116,47,'HOTEL','뉴욕 시티 호텔','HOTEL activity for Tour19','NYC',NULL,NULL,4),
(0,117,48,'POINT','로스앤젤레스 비치','POINT activity for Tour19','LAX',NULL,NULL,NULL),
(1,118,48,'AIR','파리','AIR activity for Tour19',NULL,'PAR','SYD',NULL),
(2,119,48,'AIR','런던','AIR activity for Tour19',NULL,'LON','BKK',NULL),
(0,120,49,'AIR','파리','AIR activity for Tour20',NULL,'PAR','ROM',NULL),
(1,121,49,'HOTEL','부르주 광장 호텔','HOTEL activity for Tour20','DXB',NULL,NULL,3),
(0,122,50,'HOTEL','로스앤젤레스 비치 호텔','HOTEL activity for Tour20','LAX',NULL,NULL,4),
(1,123,50,'HOTEL','방콕 팰리스','HOTEL activity for Tour20','BKK',NULL,NULL,4);

UPDATE tour t
JOIN (
    SELECT 
        t.id AS tour_id,
        COALESCE(SUM(CASE WHEN l.location_type = 'HOTEL' THEN h.price END), 0) AS hotel_price_sum
    FROM tour t
    LEFT JOIN schedule s 
        ON s.tour_id = t.id
    LEFT JOIN location l 
        ON l.schedule_id = s.id
    LEFT JOIN hotel h 
        ON l.hotel_id = h.id
    GROUP BY t.id
) x ON t.id = x.tour_id
SET t.hotel_price_sum = x.hotel_price_sum;